stages:
  - staging
  - production

# Manual deploy only; CI jobs (tests/build) can be added later.

deploy_staging:
  stage: staging
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
      when: on_success
    - when: never
  script:
    - docker compose -f docker-compose.staging.yml up -d --build

deploy_production:
  stage: production
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
      when: manual
    - when: never
  script:
    - docker compose -f docker-compose.prod.yml up -d --build
